"use strict";window.onload=function(){function e(e){return document.querySelector(e).value}var t=document.querySelector(".notepad-add-button .add"),o=document.querySelector(".main__notepad-add-popup .notepad__close-button"),n=document.querySelector(".main__notepad-add-popup"),a=document.querySelector(".main__notepad-add-popup .form-add .add"),p=document.querySelectorAll(".note-button-edit"),d=document.querySelector(".main__notepad-edit-popup .notepad__close-button"),s=document.querySelector(".main__notepad-edit-popup"),r=document.querySelector(".main__notepad-edit-popup .form-text"),i=document.querySelector(".main__notepad-edit-popup .form-edit .edit"),u="";t.addEventListener("click",function(e){n.classList.contains("notepad-popup--close")&&(n.classList.remove("notepad-popup--close"),n.classList.add("notepad-popup--open"))}),o.addEventListener("click",function(){e(".main__notepad-add-popup .form-add .form-text")?!0===confirm("Вы точно хотите закрыть форму добавления заметки?")&&(n.classList.remove("notepad-popup--open"),n.classList.add("notepad-popup--close")):(n.classList.remove("notepad-popup--open"),n.classList.add("notepad-popup--close"))}),a.addEventListener("click",function(){if(e(".main__notepad-add-popup .form-add .form-text")){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE&&404===t.status&&alert("Запись не добавилась, исполняемый файл не найден"),t.readyState===XMLHttpRequest.DONE&&504===t.status&&alert("Запись не добавилась, долгое исполнение файла"),t.readyState===XMLHttpRequest.DONE&&200===t.status)if("error"===t.response[0])alert("Изменение не было записано. Проблема с базой данный "+t.response[1]);else{var o=document.querySelector(".main__notepad-notes .container"),a=document.createElement("div");a.className="note",a.id=t.response,a.innerHTML='<div class="note-text">\n                            <p class="text">'+e(".main__notepad-add-popup .form-add .form-text")+'</p>\n                        </div>\n\n                        <div class="note-button-edit">\n                            <a class="button blue-button edit"><i class="fa fa-edit"></i></a>\n                        </div>\n                        <div class="note-button-remove">\n                            <a class="button red-button delete"><i class="fa fa-remove"></i></a>\n                        </div>',o.append(a),n.classList.remove("notepad-popup--open"),n.classList.add("notepad-popup--close");var p=a.querySelector(".note-button-edit"),d=a.querySelector(".note-button-remove");p.addEventListener("click",function(){s.classList.contains("notepad-popup--close")&&(r.value=a.querySelector(".note-text .text").textContent,u=a.querySelector(".note-text .text"),s.classList.remove("notepad-popup--close"),s.classList.add("notepad-popup--open"))}),d.addEventListener("click",function(){if(!0===confirm("Вы точно хотите удалить эту запись?")){var e=new XMLHttpRequest;e.onreadystatechange=function(){e.readyState===XMLHttpRequest.DONE&&404===e.status&&alert("Запись не удалилась, исполняемый файл не найден"),e.readyState===XMLHttpRequest.DONE&&504===e.status&&alert("Запись не удалилась, долгое исполнение файла"),e.readyState===XMLHttpRequest.DONE&&200===e.status&&("error"===e.response[0]?alert("Изменение не было записано. Проблема с базой данный "+e.response[1]):a.remove())},e.responseType="json",e.open("post","ajax/removeNote.php",!0),e.setRequestHeader("Content-type","application/x-www-form-urlencoded"),e.send("id="+a.id)}})}},t.responseType="json",t.open("post","ajax/addNote.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("text="+e(".main__notepad-add-popup .form-add .form-text"))}else alert("Вы ничего не ввели!")}),p.forEach(function(e){e.addEventListener("click",function(){s.classList.contains("notepad-popup--close")&&(r.value=this.parentNode.children[0].children[0].textContent,u=this.parentNode.children[0].children[0],s.classList.remove("notepad-popup--close"),s.classList.add("notepad-popup--open"))})}),d.addEventListener("click",function(){e(".main__notepad-edit-popup .form-edit .form-text")!==u.textContent?!0===confirm("Вы точно хотите закрыть форму изменения заметки?")&&(s.classList.remove("notepad-popup--open"),s.classList.add("notepad-popup--close")):(s.classList.remove("notepad-popup--open"),s.classList.add("notepad-popup--close"))}),i.addEventListener("click",function(){if(e(".main__notepad-edit-popup .form-edit .form-text")!==u.textContent&&""!==e(".main__notepad-edit-popup .form-edit .form-text")){var t=new XMLHttpRequest;t.onreadystatechange=function(){t.readyState===XMLHttpRequest.DONE&&404===t.status&&alert("Запись не изменилась, исполняемый файл не найден"),t.readyState===XMLHttpRequest.DONE&&504===t.status&&alert("Запись не изменилась, долгое исполнение файла"),t.readyState===XMLHttpRequest.DONE&&200===t.status&&("error"===t.response[0]?alert("Изменение не было записано. Проблема с базой данный "+t.response[1]):(u.textContent=e(".main__notepad-edit-popup .form-edit .form-text"),s.classList.remove("notepad-popup--open"),s.classList.add("notepad-popup--close")))},t.responseType="json",t.open("post","ajax/editNote.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("id="+u.parentNode.parentNode.id+"&text="+e(".main__notepad-edit-popup .form-edit .form-text"))}else alert("Вы ничего не ввели или текст не отличается от исходного!")}),document.querySelectorAll(".note-button-remove").forEach(function(e){e.addEventListener("click",function(){if(!0===confirm("Вы точно хотите удалить эту запись?")){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE&&404===t.status&&alert("Запись не удалилась, исполняемый файл не найден"),t.readyState===XMLHttpRequest.DONE&&504===t.status&&alert("Запись не удалилась, долгое исполнение файла"),t.readyState===XMLHttpRequest.DONE&&200===t.status)if("error"===t.response[0])alert("Изменение не было записано. Проблема с базой данный "+t.response[1]);else{var o=document.querySelector(".main__notepad-notes .container");o.removeChild(e.parentNode)}},t.responseType="json",t.open("post","ajax/removeNote.php",!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.send("id="+this.parentNode.id)}})})};